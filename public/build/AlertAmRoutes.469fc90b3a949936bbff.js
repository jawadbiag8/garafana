(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"9f6O":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var a=n("t8hP"),r=n("q1tI"),l=n("Ty5D");function i(){const{search:t}=Object(l.l)();return[Object(r.useMemo)(()=>Object(a.locationSearchToObject)(t||""),[t]),Object(r.useCallback)((t,n)=>e(()=>a.locationService.partial(t,n)),[])]}}).call(this,n("URgk").setImmediate)},"Ev/k":function(e,t,n){"use strict";n.r(t);var a=n("q1tI"),r=n("vF1F"),l=n("kDLi"),i=n("/MKj"),o=n("Ty5D"),s=n("SGmB"),c=n("sbt+"),d=n("lcDh"),u=n("G1gI"),p=n("Sp9v"),j=n("LvDl");function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}const g=["",u.d[0].value],m=(e,t)=>Object.entries(null!=e?e:{}).reduce((e,[n,a])=>[...e,{name:n,value:a,isRegex:t,isEqual:!0}],[]),v=e=>{if(!e)return g;const[t,n]=e?Object(u.b)(e):[void 0,void 0],a=u.d.find(e=>e.value===n);return t&&a?[String(t),a.value]:g},h=e=>e.value,f={name:"",value:"",isRegex:!1,isEqual:!0},O={id:"",groupBy:[],matchers:[],routes:[],continue:!1,receiver:"",groupWaitValue:"",groupWaitValueType:u.d[0].value,groupIntervalValue:"",groupIntervalValueType:u.d[0].value,repeatIntervalValue:"",repeatIntervalValueType:u.d[0].value},x=e=>{var t,n,a,r,l,i;if(!e||0===Object.keys(e).length)return[O,{}];const[o,s]=v(e.group_wait),[c,d]=v(e.group_interval),[u,j]=v(e.repeat_interval),b=String(Math.random()),g={[b]:e},h=[];return null===(t=e.routes)||void 0===t||t.forEach(e=>{const[t,n]=x(e);h.push(t),Object.assign(g,n)}),[{id:b,matchers:[...null!==(n=null===(a=e.matchers)||void 0===a?void 0:a.map(p.d))&&void 0!==n?n:[],...m(e.match,!1),...m(e.match_re,!0)],continue:null!==(r=e.continue)&&void 0!==r&&r,receiver:null!==(l=e.receiver)&&void 0!==l?l:"",groupBy:null!==(i=e.group_by)&&void 0!==i?i:[],groupWaitValue:o,groupWaitValueType:s,groupIntervalValue:c,groupIntervalValueType:d,repeatIntervalValue:u,repeatIntervalValueType:j,routes:h},g]},y=(e,t)=>{const n=t[e.id],a=b({},null!=n?n:{},{continue:e.continue,group_by:e.groupBy,matchers:e.matchers.length?e.matchers.map(p.e):void 0,match:void 0,match_re:void 0,group_wait:e.groupWaitValue?`${e.groupWaitValue}${e.groupWaitValueType}`:void 0,group_interval:e.groupIntervalValue?`${e.groupIntervalValue}${e.groupIntervalValueType}`:void 0,repeat_interval:e.repeatIntervalValue?`${e.repeatIntervalValue}${e.repeatIntervalValueType}`:void 0,routes:e.routes.map(e=>y(e,t))});return e.receiver&&(a.receiver=e.receiver),Object(j.omitBy)(a,j.isUndefined)},C=e=>({label:e,value:e}),I=e=>(null!=e?e:[]).map(C),w=e=>{var t;return e&&null!==(t=h(e))&&void 0!==t?t:""},$=e=>{return e?(null!=(t=e)?t:[]).map(h):[];var t},N=e=>{if(e)return/^\d+$/.test(e)?void 0:"Must be a positive integer."};var S=n("8qpb");const V=e=>({container:r.css`
      align-items: center;
      display: flex;
      flex-flow: row nowrap;

      & > * + * {
        margin-left: ${e.spacing(1)};
      }
    `,input:r.css`
      flex: 1;
    `,timingContainer:r.css`
      max-width: ${e.spacing(33)};
    `,smallInput:r.css`
      width: ${e.spacing(6.5)};
    `});var k,T,F=n("nKUr");function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}const M=({alertManagerSourceName:e,onCancel:t,onSave:n,receivers:i,routes:o})=>{var s;const c=Object(l.useStyles2)(V),[d,p]=Object(a.useState)(!1),[j,b]=Object(a.useState)(I(o.groupBy));return Object(F.jsx)(l.Form,{defaultValues:o,onSubmit:n,children:({control:n,errors:a,setValue:o})=>{var g,m,v,h;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(l.Field,{label:"Default contact point",invalid:!!a.receiver,error:null===(g=a.receiver)||void 0===g?void 0:g.message,children:Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("div",{className:c.container,"data-testid":"am-receiver-select",children:[Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=E(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,B({},n,{className:c.input,onChange:e=>t(w(e)),options:i}))},control:n,name:"receiver",rules:{required:{value:!0,message:"Required."}}}),k||(k=Object(F.jsx)("span",{children:"or"})),Object(F.jsx)(l.Link,{href:Object(S.e)("/alerting/notifications/receivers/new",e),children:"Create a contact point"})]})})}),Object(F.jsx)(l.Field,{label:"Group by",description:"Group alerts when you receive a notification based on labels.","data-testid":"am-group-select",children:Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=E(e.field,["onChange","ref"]);return Object(F.jsx)(l.MultiSelect,B({},n,{allowCustomValue:!0,className:c.input,onCreateOption:e=>{b(t=>[...t,C(e)]),o("groupBy",[...n.value,e])},onChange:e=>t($(e)),options:j}))},control:n,name:"groupBy"})}),Object(F.jsxs)(l.Collapse,{collapsible:!0,isOpen:d,label:"Timing options",onToggle:p,children:[Object(F.jsx)(l.Field,{label:"Group wait",description:"The waiting time until the initial notification is sent for a new group created by an incoming alert. Default 30 seconds.",invalid:!!a.groupWaitValue,error:null===(m=a.groupWaitValue)||void 0===m?void 0:m.message,"data-testid":"am-group-wait",children:Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("div",{className:Object(r.cx)(c.container,c.timingContainer),children:[Object(F.jsx)(l.InputControl,{render:({field:e,fieldState:{invalid:t}})=>Object(F.jsx)(l.Input,B({},e,{className:c.smallInput,invalid:t})),control:n,name:"groupWaitValue",rules:{validate:N}}),Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=E(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,B({},n,{className:c.input,onChange:e=>t(w(e)),options:u.d}))},control:n,name:"groupWaitValueType"})]})})}),Object(F.jsx)(l.Field,{label:"Group interval",description:"The waiting time to send a batch of new alerts for that group after the first notification was sent. Default 5 minutes.",invalid:!!a.groupIntervalValue,error:null===(v=a.groupIntervalValue)||void 0===v?void 0:v.message,"data-testid":"am-group-interval",children:Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("div",{className:Object(r.cx)(c.container,c.timingContainer),children:[Object(F.jsx)(l.InputControl,{render:({field:e,fieldState:{invalid:t}})=>Object(F.jsx)(l.Input,B({},e,{className:c.smallInput,invalid:t})),control:n,name:"groupIntervalValue",rules:{validate:N}}),Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=E(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,B({},n,{className:c.input,onChange:e=>t(w(e)),options:u.d}))},control:n,name:"groupIntervalValueType"})]})})}),Object(F.jsx)(l.Field,{label:"Repeat interval",description:"The waiting time to resend an alert after they have successfully been sent. Default 4 hours.",invalid:!!a.repeatIntervalValue,error:null===(h=a.repeatIntervalValue)||void 0===h?void 0:h.message,"data-testid":"am-repeat-interval",children:Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("div",{className:Object(r.cx)(c.container,c.timingContainer),children:[Object(F.jsx)(l.InputControl,{render:({field:e,fieldState:{invalid:t}})=>Object(F.jsx)(l.Input,B({},e,{className:c.smallInput,invalid:t})),control:n,name:"repeatIntervalValue",rules:{validate:N}}),Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=E(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,B({},n,{className:c.input,menuPlacement:"top",onChange:e=>t(w(e)),options:u.d}))},control:n,name:"repeatIntervalValueType"})]})})})]}),Object(F.jsxs)("div",{className:c.container,children:[T||(T=Object(F.jsx)(l.Button,{type:"submit",children:"Save"})),s||(s=Object(F.jsx)(l.Button,{onClick:t,type:"reset",variant:"secondary",fill:"outline",children:"Cancel"}))]})]})}})},R=e=>({container:r.css`
      display: grid;
      font-style: ${e.typography.fontSize};
      grid-template-columns: ${e.spacing(15.5)} auto;

      ${e.breakpoints.down("md")} {
        grid-template-columns: 100%;
      }
    `,titleCell:r.css`
      color: ${e.colors.text.primary};
    `,valueCell:r.css`
      color: ${e.colors.text.secondary};
      margin-bottom: ${e.spacing(1)};
    `}),_=({routes:e})=>{const t=Object(l.useStyles2)(R),n=e.receiver||"-",a=e.groupBy.join(", ")||"-",r=e.groupWaitValue?`${e.groupWaitValue}${e.groupWaitValueType}`:"-",i=e.groupIntervalValue?`${e.groupIntervalValue}${e.groupIntervalValueType}`:"-",o=e.repeatIntervalValue?`${e.repeatIntervalValue}${e.repeatIntervalValueType}`:"-";return Object(F.jsxs)("div",{className:t.container,children:[Object(F.jsx)("div",{className:t.titleCell,children:"Contact point"}),Object(F.jsx)("div",{className:t.valueCell,"data-testid":"am-routes-root-receiver",children:n}),Object(F.jsx)("div",{className:t.titleCell,children:"Group by"}),Object(F.jsx)("div",{className:t.valueCell,"data-testid":"am-routes-root-group-by",children:a}),Object(F.jsx)("div",{className:t.titleCell,children:"Timings"}),Object(F.jsxs)("div",{className:t.valueCell,"data-testid":"am-routes-root-timings",children:["Group wait: ",r," | Group interval: ",i," | Repeat interval: ",o]})]})};var G,W;const L=({isEditMode:e,onSave:t,onEnterEditMode:n,onExitEditMode:a,receivers:r,routes:i,alertManagerSourceName:o})=>{const s=Object(l.useStyles2)(q);return Object(F.jsxs)("div",{className:s.container,"data-testid":"am-root-route-container",children:[Object(F.jsxs)("div",{className:s.titleContainer,children:[Object(F.jsxs)("h5",{className:s.title,children:["Root policy - ",G||(G=Object(F.jsx)("i",{children:"default for all alerts"}))]}),!e&&Object(F.jsx)(l.Button,{icon:"pen",onClick:n,size:"sm",type:"button",variant:"secondary",children:"Edit"})]}),W||(W=Object(F.jsx)("p",{children:"All alerts will go to the default contact point, unless you set additional matchers in the specific routing area."})),e?Object(F.jsx)(M,{alertManagerSourceName:o,onCancel:a,onSave:t,receivers:r,routes:i}):Object(F.jsx)(_,{routes:i})]})},q=e=>({container:r.css`
      background-color: ${e.colors.background.secondary};
      color: ${e.colors.text.secondary};
      padding: ${e.spacing(2)};
    `,titleContainer:r.css`
      color: ${e.colors.text.primary};
      display: flex;
      flex-flow: row nowrap;
    `,title:r.css`
      flex: 100%;
    `}),z=({buttonIcon:e,buttonLabel:t,buttonSize:n="lg",buttonVariant:a="primary",onButtonClick:r,text:i})=>{const o=Object(l.useStyles)(A);return Object(F.jsxs)("div",{className:o.container,children:[Object(F.jsx)("p",{className:o.text,children:i}),Object(F.jsx)(l.Button,{className:o.button,icon:e,onClick:r,size:n,type:"button",variant:a,children:t})]})},A=e=>({container:r.css`
      background-color: ${e.colors.bg2};
      color: ${e.colors.textSemiWeak};
      padding: ${e.spacing.xl};
      text-align: center;
    `,text:r.css`
      margin-bottom: ${e.spacing.md};
    `,button:r.css`
      margin: ${e.spacing.md} 0 ${e.spacing.sm};
    `});var D,P,U=n("wDOy");function K(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}const Y=({onCancel:e,onSave:t,receivers:n,routes:i})=>{var o;const s=Object(l.useStyles2)(H),c=Object(l.useStyles2)(V),[d,p]=Object(a.useState)(i.groupBy.length>0),[j,b]=Object(a.useState)(!!i.groupWaitValue||!!i.groupIntervalValue||!!i.repeatIntervalValue),[g,m]=Object(a.useState)(I(i.groupBy));return Object(F.jsx)(l.Form,{defaultValues:i,onSubmit:t,children:({control:t,register:a,errors:i,setValue:v})=>{var h,O,x;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("input",J({type:"hidden"},a("id"))),Object(F.jsx)(l.FieldArray,{name:"matchers",control:t,children:({fields:e,append:t,remove:n})=>Object(F.jsxs)(F.Fragment,{children:[D||(D=Object(F.jsx)("div",{children:"Matching labels"})),Object(F.jsx)("div",{className:s.matchersContainer,children:e.map((e,t)=>{var r,o,c,d,u,p,j,b,g,m;const v=`matchers[${t}]`;return Object(F.jsxs)(l.HorizontalGroup,{align:"flex-start",children:[Object(F.jsx)(l.Field,{label:"Label",invalid:!(null===(r=i.matchers)||void 0===r||null===(o=r[t])||void 0===o||!o.name),error:null===(c=i.matchers)||void 0===c||null===(d=c[t])||void 0===d||null===(u=d.name)||void 0===u?void 0:u.message,children:Object(F.jsx)(l.Input,J({},a(v+".name",{required:"Field is required"}),{defaultValue:e.name,placeholder:"label"}))}),Object(F.jsx)(l.Field,{label:"Value",invalid:!(null===(p=i.matchers)||void 0===p||null===(j=p[t])||void 0===j||!j.value),error:null===(b=i.matchers)||void 0===b||null===(g=b[t])||void 0===g||null===(m=g.value)||void 0===m?void 0:m.message,children:Object(F.jsx)(l.Input,J({},a(v+".value",{required:"Field is required"}),{defaultValue:e.value,placeholder:"value"}))}),Object(F.jsx)(l.Field,{className:s.matcherRegexField,label:"Regex",children:Object(F.jsx)(l.Checkbox,J({},a(v+".isRegex"),{defaultChecked:e.isRegex}))}),Object(F.jsx)(l.Field,{className:s.matcherRegexField,label:"Equal",children:Object(F.jsx)(l.Checkbox,J({},a(v+".isEqual"),{defaultChecked:e.isEqual}))}),Object(F.jsx)(l.IconButton,{className:s.removeButton,tooltip:"Remove matcher",name:"trash-alt",onClick:()=>n(t),children:"Remove"})]},e.id)})}),Object(F.jsx)(l.Button,{className:s.addMatcherBtn,icon:"plus",onClick:()=>t(f),variant:"secondary",type:"button",children:"Add matcher"})]})}),Object(F.jsx)(l.Field,{label:"Contact point",children:Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=K(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,J({},a,{className:c.input,onChange:e=>t(w(e)),options:n}))},control:t,name:"receiver"})}),Object(F.jsx)(l.Field,{label:"Continue matching subsequent sibling nodes",children:Object(F.jsx)(l.Switch,J({},a("continue")))}),Object(F.jsx)(l.Field,{label:"Override grouping",children:Object(F.jsx)(l.Switch,{value:d,onChange:()=>p(e=>!e)})}),d&&Object(F.jsx)(l.Field,{label:"Group by",description:"Group alerts when you receive a notification based on labels.",children:Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=K(e.field,["onChange","ref"]);return Object(F.jsx)(l.MultiSelect,J({},n,{allowCustomValue:!0,className:c.input,onCreateOption:e=>{m(t=>[...t,C(e)]),v("groupBy",[...n.value,e])},onChange:e=>t($(e)),options:g}))},control:t,name:"groupBy"})}),Object(F.jsx)(l.Field,{label:"Override general timings",children:Object(F.jsx)(l.Switch,{value:j,onChange:()=>b(e=>!e)})}),j&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(l.Field,{label:"Group wait",description:"The waiting time until the initial notification is sent for a new group created by an incoming alert.",invalid:!!i.groupWaitValue,error:null===(h=i.groupWaitValue)||void 0===h?void 0:h.message,children:Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("div",{className:Object(r.cx)(c.container,c.timingContainer),children:[Object(F.jsx)(l.InputControl,{render:({field:e,fieldState:{invalid:t}})=>Object(F.jsx)(l.Input,J({},e,{className:c.smallInput,invalid:t})),control:t,name:"groupWaitValue",rules:{validate:N}}),Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=K(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,J({},n,{className:c.input,onChange:e=>t(w(e)),options:u.d}))},control:t,name:"groupWaitValueType"})]})})}),Object(F.jsx)(l.Field,{label:"Group interval",description:"The waiting time to send a batch of new alerts for that group after the first notification was sent.",invalid:!!i.groupIntervalValue,error:null===(O=i.groupIntervalValue)||void 0===O?void 0:O.message,children:Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("div",{className:Object(r.cx)(c.container,c.timingContainer),children:[Object(F.jsx)(l.InputControl,{render:({field:e,fieldState:{invalid:t}})=>Object(F.jsx)(l.Input,J({},e,{className:c.smallInput,invalid:t})),control:t,name:"groupIntervalValue",rules:{validate:N}}),Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=K(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,J({},n,{className:c.input,onChange:e=>t(w(e)),options:u.d}))},control:t,name:"groupIntervalValueType"})]})})}),Object(F.jsx)(l.Field,{label:"Repeat interval",description:"The waiting time to resend an alert after they have successfully been sent.",invalid:!!i.repeatIntervalValue,error:null===(x=i.repeatIntervalValue)||void 0===x?void 0:x.message,children:Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("div",{className:Object(r.cx)(c.container,c.timingContainer),children:[Object(F.jsx)(l.InputControl,{render:({field:e,fieldState:{invalid:t}})=>Object(F.jsx)(l.Input,J({},e,{className:c.smallInput,invalid:t})),control:t,name:"repeatIntervalValue",rules:{validate:N}}),Object(F.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,n=K(e.field,["onChange","ref"]);return Object(F.jsx)(l.Select,J({},n,{className:c.input,menuPlacement:"top",onChange:e=>t(w(e)),options:u.d}))},control:t,name:"repeatIntervalValueType"})]})})})]}),Object(F.jsxs)("div",{className:s.buttonGroup,children:[P||(P=Object(F.jsx)(l.Button,{type:"submit",children:"Save policy"})),o||(o=Object(F.jsx)(l.Button,{onClick:e,fill:"outline",type:"button",variant:"secondary",children:"Cancel"}))]})]})}})},H=e=>{const t=e.spacing(3.5);return{addMatcherBtn:r.css`
      margin-bottom: ${t};
    `,matchersContainer:r.css`
      background-color: ${e.colors.background.secondary};
      margin: ${e.spacing(1,0)};
      padding: ${e.spacing(1,4.6,1,1.5)};
      width: fit-content;
    `,matcherRegexField:r.css`
      margin-left: ${e.spacing(6)};
    `,nestedPolicies:r.css`
      margin-top: ${t};
    `,removeButton:r.css`
      margin-left: ${e.spacing(1)};
      margin-top: ${e.spacing(2.5)};
    `,buttonGroup:r.css`
      margin: ${e.spacing(6)} 0 ${t};

      & > * + * {
        margin-left: ${e.spacing(1.5)};
      }
    `}};var X;function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}const Z=({onChange:e,receivers:t,routes:n})=>{const r=Object(l.useStyles2)(ee),i=Object(l.useStyles2)(R),o=n.groupWaitValue?`${n.groupWaitValue}${n.groupWaitValueType}`:"-",s=n.groupIntervalValue?`${n.groupIntervalValue}${n.groupIntervalValueType}`:"-",c=n.repeatIntervalValue?`${n.repeatIntervalValue}${n.repeatIntervalValueType}`:"-",[d,u]=Object(a.useState)(n.routes),[p,j]=Object(a.useState)(!1);return Object(F.jsxs)("div",{className:i.container,children:[Object(F.jsx)("div",{className:i.titleCell,children:"Group wait"}),Object(F.jsx)("div",{className:i.valueCell,children:o}),Object(F.jsx)("div",{className:i.titleCell,children:"Group interval"}),Object(F.jsx)("div",{className:i.valueCell,children:s}),Object(F.jsx)("div",{className:i.titleCell,children:"Repeat interval"}),Object(F.jsx)("div",{className:i.valueCell,children:c}),Object(F.jsx)("div",{className:i.titleCell,children:"Nested policies"}),Object(F.jsxs)("div",{className:i.valueCell,children:[d.length?Object(F.jsx)(ae,{isAddMode:p,onCancelAdd:()=>{j(!1),u(e=>{const t=[...e];return t.pop(),t})},onChange:t=>{e(Q({},n,{routes:t})),p&&j(!1)},receivers:t,routes:d}):X||(X=Object(F.jsx)("p",{children:"No nested policies configured."})),!p&&Object(F.jsx)(l.Button,{className:r.addNestedRoutingBtn,icon:"plus",onClick:()=>{u(e=>[...e,O]),j(!0)},variant:"secondary",type:"button",children:"Add nested policy"})]})]})},ee=e=>({addNestedRoutingBtn:r.css`
      margin-top: ${e.spacing(2)};
    `});var te=n("Jv5Q");function ne(){return(ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}const ae=({isAddMode:e,onCancelAdd:t,onChange:n,receivers:r,routes:i})=>{const[o,s]=Object(a.useState)(!1),[c,d]=Object(a.useState)(),u=Object(a.useCallback)(e=>d(e.id),[]),p=Object(a.useCallback)(()=>d(void 0),[]),j=[{id:"matchingCriteria",label:"Matching labels",renderCell:e=>Object(F.jsx)(te.a,{matchers:e.data.matchers}),size:10},{id:"groupBy",label:"Group by",renderCell:e=>e.data.groupBy.join(", ")||"-",size:5},{id:"receiverChannel",label:"Contact point",renderCell:e=>e.data.receiver||"-",size:5},{id:"actions",label:"Actions",renderCell:(e,t)=>{if(e.renderExpandedContent)return null;return Object(F.jsxs)(l.HorizontalGroup,{children:[Object(F.jsx)(l.Button,{icon:"pen",onClick:()=>{u(e),s(!0)},size:"sm",type:"button",variant:"secondary",children:"Edit"}),Object(F.jsx)(l.IconButton,{name:"trash-alt",onClick:()=>{const e=[...i];e.splice(t,1),n(e)},type:"button"})]})},size:"100px"}],b=Object(a.useMemo)(()=>((e,t)=>e.map((e,n)=>{var a;return{id:null!==(a=null==t?void 0:t(e))&&void 0!==a?a:n,data:e}}))(i),[i]);return Object(a.useEffect)(()=>{e&&b.length&&d(b[b.length-1].id)},[e,b]),Object(F.jsx)(U.a,{cols:j,isExpandable:!0,items:b,testIdGenerator:()=>"am-routes-row",onCollapse:p,onExpand:u,isExpanded:e=>c===e.id,renderExpandedContent:(a,l)=>e||o?Object(F.jsx)(Y,{onCancel:()=>{e&&t(),s(!1)},onSave:e=>{const t=[...i];t[l]=ne({},t[l],e),s(!1),n(t)},receivers:r,routes:a.data}):Object(F.jsx)(Z,{onChange:e=>{const t=[...i];t[l]=ne({},a.data,e),n(t)},receivers:r,routes:a.data})})};var re,le;function ie(){return(ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}const oe=({onChange:e,onRootRouteEdit:t,receivers:n,routes:r})=>{const[i,o]=Object(a.useState)(r.routes),[s,c]=Object(a.useState)(!1),d=Object(l.useStyles2)(se),u=()=>{c(!0),o(e=>[...e,ie({},O,{matchers:[f]})])};return Object(F.jsxs)("div",{className:d.container,children:[re||(re=Object(F.jsx)("h5",{children:"Specific routing"})),le||(le=Object(F.jsx)("p",{children:"Send specific alerts to chosen contact points, based on matching criteria"})),r.receiver?i.length>0?Object(F.jsxs)(F.Fragment,{children:[!s&&Object(F.jsx)(l.Button,{className:d.addMatcherBtn,icon:"plus",onClick:u,type:"button",children:"New policy"}),Object(F.jsx)(ae,{isAddMode:s,onCancelAdd:()=>{c(!1),o(e=>{const t=[...e];return t.pop(),t})},onChange:t=>{e(ie({},r,{routes:t})),s&&c(!1)},receivers:n,routes:i})]}):Object(F.jsx)(z,{buttonIcon:"plus",buttonLabel:"New specific policy",onButtonClick:u,text:"You haven't created any specific policies yet."}):Object(F.jsx)(z,{buttonIcon:"rocket",buttonLabel:"Set a default contact point",onButtonClick:t,text:"You haven't set a default contact point for the root route yet."})]})},se=e=>({container:r.css`
      display: flex;
      flex-flow: column nowrap;
    `,addMatcherBtn:r.css`
      align-self: flex-end;
      margin-bottom: ${e.spacing(3.5)};
    `});var ce,de,ue=n("dEXO"),pe=n("w+lj"),je=n("4Yfp"),be=n("fXZ9");function ge(){return(ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.default=Object(l.withErrorBoundary)(()=>{var e;const t=Object(i.useDispatch)(),n=Object(l.useStyles2)(me),[r,u]=Object(a.useState)(!1),[p,j]=Object(ue.a)(),b=Object(pe.a)(e=>e.amConfigs),g=Object(a.useCallback)(()=>{p&&t(Object(je.f)(p))},[p,t]);Object(a.useEffect)(()=>{g()},[g]);const{result:m,loading:v,error:h}=p&&b[p]||be.c,f=null==m?void 0:m.alertmanager_config,[O,C]=Object(a.useMemo)(()=>x(null==f?void 0:f.route),[null==f?void 0:f.route]),w=I((null!==(e=null==f?void 0:f.receivers)&&void 0!==e?e:[]).map(e=>e.name)),$=()=>{u(!0)},N=()=>{u(!1)};Object(s.a)(e=>e.unifiedAlerting.saveAMConfig);const S=e=>{const n=y(ge({},O,e),C);r&&N(),t(Object(je.s)({newConfig:ge({},m,{alertmanager_config:ge({},m.alertmanager_config,{route:n})}),oldConfig:m,alertManagerSourceName:p,successMessage:"Saved",refetch:!0}))};return p?Object(F.jsxs)(c.a,{pageId:"am-routes",children:[Object(F.jsx)(d.a,{current:p,onChange:j}),h&&!v&&Object(F.jsx)(l.Alert,{severity:"error",title:"Error loading alert manager config",children:h.message||"Unknown error."}),v&&(de||(de=Object(F.jsx)(l.LoadingPlaceholder,{text:"Loading alert manager config..."}))),m&&!v&&!h&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(L,{alertManagerSourceName:p,isEditMode:r,onSave:S,onEnterEditMode:$,onExitEditMode:N,receivers:w,routes:O}),Object(F.jsx)("div",{className:n.break}),Object(F.jsx)(oe,{onChange:S,onRootRouteEdit:$,receivers:w,routes:O})]})]}):ce||(ce=Object(F.jsx)(o.c,{to:"/alerting/routes"}))},{style:"page"});const me=e=>({break:r.css`
    width: 100%;
    height: 0;
    margin-bottom: ${e.spacing(2)};
    border-bottom: solid 1px ${e.colors.border.medium};
  `})},Jv5Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("q1tI"),r=n("kDLi"),l=n("vF1F"),i=n("A5n/"),o=n("Sp9v"),s=n("nKUr");const c=({matchers:e,onRemoveLabel:t})=>{const n=Object(r.useStyles)(d),l=Object(a.useCallback)(e=>{t&&t(e)},[t]);return Object(s.jsx)("div",{className:n.wrapper,children:e.map((e,n)=>{const{name:a,value:r}=e;return Object(s.jsx)(i.a,{labelKey:a,value:r,operator:Object(o.c)(e),onRemoveLabel:t?()=>l(n):void 0},`${a}-${r}-${n}`)})})},d=e=>({wrapper:l.css`
    & > * {
      margin-top: ${e.spacing.xs};
      margin-right: ${e.spacing.xs};
    }
    padding-bottom: ${e.spacing.xs};
  `})},SGmB:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("q1tI"),r=n("/MKj"),l=n("zVNn");function i(e){const t=Object(r.useDispatch)(),n=Object(a.useRef)(e);n.current=e,Object(a.useEffect)(()=>()=>{t(Object(l.a)({stateSelector:n.current}))},[t])}},URgk:function(e,t,n){(function(e){var a=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function l(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new l(r.call(setTimeout,a,arguments),clearTimeout)},t.setInterval=function(){return new l(r.call(setInterval,a,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(a,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n("YBdB"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("yLpj"))},YBdB:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var a,r,l,i,o,s=1,c={},d=!1,u=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick((function(){b(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((l=new MessageChannel).port1.onmessage=function(e){b(e.data)},a=function(e){l.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(r=u.documentElement,a=function(e){var t=u.createElement("script");t.onreadystatechange=function(){b(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):a=function(e){setTimeout(b,0,e)}:(i="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&b(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),a=function(t){e.postMessage(i+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[s]=r,a(s),s++},p.clearImmediate=j}function j(e){delete c[e]}function b(e){if(d)setTimeout(b,0,e);else{var t=c[e];if(t){d=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{j(e),d=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("yLpj"),n("8oxB"))},dEXO:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("9f6O"),r=n("SMGL"),l=n("q1tI"),i=n("d6cIB"),o=n("Jzaf");function s(e){return e===o.b||!!Object(o.c)().find(t=>t.name===e)}function c(){const[e,t]=Object(a.a)(),n=Object(l.useCallback)(e=>{s(e)&&(e===o.b?(r.a.delete(i.a),t({[i.b]:null})):(r.a.set(i.a,e),t({[i.b]:e})))},[t]),c=e[i.b];if(c&&"string"==typeof c)return s(c)?[c,n]:[void 0,n];const d=r.a.get(i.a);return d&&"string"==typeof d&&s(d)?(n(d),[d,n]):[o.b,n]}},lcDh:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("Jzaf"),r=n("q1tI"),l=n("kDLi"),i=n("pz/R"),o=n("vF1F"),s=n("nKUr");const c=({onChange:e,current:t,disabled:n=!1})=>{const o=Object(l.useStyles2)(d),c=Object(r.useMemo)(()=>[{label:"Grafana",value:a.b,imgUrl:"public/img/logo-Auto-orche.png",meta:{}},...Object(i.a)().filter(e=>e.type===a.a.Alertmanager).map(e=>({label:e.name.substr(0,37),value:e.name,imgUrl:e.meta.info.logos.small,meta:e.meta}))],[]);return 1===c.length?null:Object(s.jsx)(l.Field,{className:o.field,label:n?"Alert manager":"Choose alert manager",disabled:n,"data-testid":"alertmanager-picker",children:Object(s.jsx)(l.Select,{width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:t=>t.value&&e(t.value),options:c,maxMenuHeight:500,noOptionsMessage:"No datasources found",value:t,getOptionLabel:e=>e.label})})},d=e=>({field:o.css`
    margin-bottom: ${e.spacing(4)};
  `})},"sbt+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("q1tI");var a=n("ZGyg"),r=n("lzJ5"),l=n("/MKj"),i=n("nKUr");const o=({children:e,pageId:t,isLoading:n})=>{const o=Object(r.a)(Object(l.useSelector)(e=>e.navIndex),t);return Object(i.jsx)(a.a,{navModel:o,children:Object(i.jsx)(a.a.Contents,{isLoading:n,children:e})})}},wDOy:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("q1tI"),r=n("vF1F"),l=n("kDLi"),i=n("nKUr");const o=({cols:e,items:t,isExpandable:n=!1,onCollapse:o,onExpand:c,isExpanded:d,renderExpandedContent:u,testIdGenerator:p,renderPrefixCell:j,renderPrefixHeader:b})=>{if((o||c||d)&&!(o&&c&&d))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((n||u)&&(!n||!u))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const g=Object(l.useStyles2)(s(e,n,!!b)),[m,v]=Object(a.useState)([]);return Object(i.jsxs)("div",{className:g.container,"data-testid":"dynamic-table",children:[Object(i.jsxs)("div",{className:g.row,"data-testid":"header",children:[b&&b(),n&&Object(i.jsx)("div",{className:g.cell}),e.map(e=>Object(i.jsx)("div",{className:g.cell,children:e.label},e.id))]}),t.map((t,a)=>{var s;const b=d?d(t):m.includes(t.id);return Object(i.jsxs)("div",{className:g.row,"data-testid":null!==(s=null==p?void 0:p(t,a))&&void 0!==s?s:"row",children:[j&&j(t,a),n&&Object(i.jsx)("div",{className:Object(r.cx)(g.cell,g.expandCell),children:Object(i.jsx)(l.IconButton,{size:"xl","data-testid":"collapse-toggle",className:g.expandButton,name:b?"angle-down":"angle-right",onClick:()=>(e=>{d&&o&&c?d(e)?o(e):c(e):v(m.includes(e.id)?m.filter(t=>t!==e.id):[...m,e.id])})(t),type:"button"})}),e.map(e=>Object(i.jsx)("div",{className:Object(r.cx)(g.cell,g.bodyCell),"data-column":e.label,children:e.renderCell(t,a)},`${t.id}-${e.id}`)),b&&u&&Object(i.jsx)("div",{className:g.expandedContentRow,"data-testid":"expanded-content",children:u(t,a)})]},t.id)})]})},s=(e,t,n)=>{const a=e.map(e=>e.size?"number"==typeof e.size?e.size+"fr":e.size:"auto");return t&&a.unshift("calc(1em + 16px)"),n&&a.unshift("0"),e=>({container:r.css`
      border: 1px solid ${e.colors.border.strong};
      border-radius: 2px;
      color: ${e.colors.text.secondary};
    `,row:r.css`
      display: grid;
      grid-template-columns: ${a.join(" ")};
      grid-template-rows: 1fr auto;

      &:nth-child(2n + 1) {
        background-color: ${e.colors.background.secondary};
      }

      &:nth-child(2n) {
        background-color: ${e.colors.background.primary};
      }

      ${e.breakpoints.down("sm")} {
        grid-template-columns: auto 1fr;
        grid-template-areas: 'left right';
        padding: 0 ${e.spacing(.5)};

        &:first-child {
          display: none;
        }

        ${n?"\n            & > *:first-child {\n              display: none;\n            }\n          ":""}
      }
    `,cell:r.css`
      align-items: center;
      padding: ${e.spacing(1)};

      ${e.breakpoints.down("sm")} {
        padding: ${e.spacing(1)} 0;
        grid-template-columns: 1fr;
      }
    `,bodyCell:r.css`
      overflow: hidden;
      word-break: break-all;
      ${e.breakpoints.down("sm")} {
        grid-column-end: right;
        grid-column-start: right;

        &::before {
          content: attr(data-column);
          display: block;
          color: ${e.colors.text.primary};
        }
      }
    `,expandCell:r.css`
      justify-content: center;

      ${e.breakpoints.down("sm")} {
        align-items: start;
        grid-area: left;
      }
    `,expandedContentRow:r.css`
      grid-column-end: ${a.length+1};
      grid-column-start: ${n?3:2};
      grid-row: 2;
      padding: 0 ${e.spacing(3)} 0 ${e.spacing(1)};
      position: relative;

      ${e.breakpoints.down("sm")} {
        grid-column-start: 2;
        border-top: 1px solid ${e.colors.border.strong};
        grid-row: auto;
        padding: ${e.spacing(1)} 0 0 0;
      }
    `,expandButton:r.css`
      margin-right: 0;
    `})}}}]);
//# sourceMappingURL=AlertAmRoutes.469fc90b3a949936bbff.js.map